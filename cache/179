{
	"greeting": "Greetings from The On-Line Encyclopedia of Integer Sequences! http://oeis.org/",
	"query": "id:A000179",
	"count": 1,
	"start": 0,
	"results": [
		{
			"number": 179,
			"id": "M2062 N0815",
			"data": "1,-1,0,1,2,13,80,579,4738,43387,439792,4890741,59216642,775596313,10927434464,164806435783,2649391469058,45226435601207,817056406224416,15574618910994665,312400218671253762,6577618644576902053,145051250421230224304,3343382818203784146955,80399425364623070680706,2013619745874493923699123",
			"name": "Ménage numbers: a(0) = 1, a(1) = -1, and for n \u003e= 2, a(n) = number of permutations s of [0, ..., n-1] such that s(i) != i and s(i) != i+1 (mod n) for all i.",
			"comment": [
				"According to rook theory, J. Riordan considered a(1) to be -1; see A102761. - _Vladimir Shevelev_, Apr 02 2010",
				"Or, for n\u003e=3, the number of 3 X n Latin rectangles the second row of which is full cycle with a fixed order of its elements, e.g., the cycle (x_2,x_3,...,x_n,x_1) with x_1 \u003c x_2 \u003c ... \u003c x_n. - _Vladimir Shevelev_, Mar 22 2010",
				"Muir (p. 112) gives essentially this recurrence (although without specifying any initial conditions). Compare A186638. - _N. J. A. Sloane_, Feb 24 2011",
				"Sequence discovered by Touchard in 1934. - _L. Edson Jeffery_, Nov 13 2013",
				"Although these are also known as Touchard numbers, the problem was formulated by Lucas in 1891, who gave the recurrence formula shown below. See Cerasoli et al., 1988. - _Stanislav Sykora_, Mar 14 2014",
				"From _Vladimir Shevelev_, Jun 25 2015: (Start)",
				"According to the ménage problem, 2*n!*a(n) is the number of ways of seating n married couples at 2*n chairs around a circular table, men and women in alternate positions, so that no husband is next to his wife.",
				"It is known [Riordan, ch. 7] that a(n) is the number of arrangements of n non-attacking rooks on the positions of the 1's in an n X n (0,1)-matrix A_n with 0's in positions (i,i), i = 1,...,n, (i,i+1), i = 1,...,n-1, and (n,1). This statement could be written as a(n) = per(A_n). For example, A_5 has the form",
				"001*11",
				"1*0011",
				"11001*                        (1)",
				"11*100",
				"0111*0,",
				"where 5 non-attacking rooks are denoted by {1*}.",
				"We can indicate a one-to-one correspondence between arrangements of n non-attacking rooks on the 1's of a matrix A_n and arrangements of n married couples around a circular table by the rules of the ménage problem, after the ladies w_1, w_2,..., w_n have taken the chairs numbered",
				"2*n, 2, 4, ..., 2*n-2         (2)",
				"respectively. Suppose we consider an  arrangement of rooks: (1,j_1), (2,j_2),..., (n,j_n). Then the men m_1, m_2,..., m_n took chairs with numbers",
				"2*j_i - 3 (mod 2*n),          (3)",
				"where the residues are chosen from the interval[1,2*n]. Indeed {j_i} is a permutation of 1,...,n. So {2*j_i-3}(mod 2*n) is a permutation of odd positive integers \u003c= 2*n-1. Besides, the distance between m_i and w_i cannot be 1. Indeed, the equality |2*(j_i-i)-1| = 1 (mod 2*n) is possible if and only if either j_i=i or j_i=i+1 (mod n) that correspond to positions of 0's in matrix A_n.",
				"For example, in the case of positions of {1*} in(1) we have j_1=3, j_2=1, j_3=5, j_4=2, j_5=4. So, by(2) and (3) the chairs 1,2,...,10 are taken by m_4, w_2, m_1, w_3, m_5, w_4, m_3, w_5, m_2, w_1, respectively. (End)",
				"The first 20 terms of this sequence were calculated in 1891 by E. Lucas (see [Lucas, p. 495]). - _Peter J. C. Moses_, Jun 26 2015",
				"From _Ira M. Gessel_, Nov 27 2018: (Start)",
				"If we invert the formula",
				"  Sum_{ n\u003e=0 } u_n z^n = ((1-z)/(1+z)) F(z/(1+z)^2)",
				"that Don Knuth mentions (see link) (i.e., set x=z/(1+z)^2 and solve for z in terms of x), we get a formula for F(z) = Sum_{n \u003e= 0} n! z^n as a sum with all positive coefficients of (almost) powers of the Catalan number generating function.",
				"The exact formula is (5) of the Yiting Li article.",
				"This article also gives a combinatorial proof of this formula (though it is not as simple as one might want). (End)"
			],
			"reference": [
				"W. W. R. Ball and H. S. M. Coxeter, Mathematical Recreations and Essays, 13th Ed. Dover, p. 50.",
				"M. Cerasoli, F. Eugeni and M. Protasi, Elementi di Matematica Discreta, Nicola Zanichelli Editore, Bologna 1988, Chapter 3, p. 78.",
				"L. Comtet, Advanced Combinatorics, Reidel, 1974, p. 185, mu(n).",
				"Kaplansky, Irving and Riordan, John, The probleme des menages, Scripta Math. 12, (1946). 113-124.",
				"E. Lucas, Théorie des nombres, Paris, 1891, pp. 491-495.",
				"P. A. MacMahon, Combinatory Analysis. Cambridge Univ. Press, London and New York, Vol. 1, 1915 and Vol. 2, 1916; see vol. 1, p 256.",
				"T. Muir, A Treatise on the Theory of Determinants. Dover, NY, 1960, Sect. 132, p. 112. - _N. J. A. Sloane_, Feb 24 2011",
				"J. Riordan, An Introduction to Combinatorial Analysis, Wiley, 1958, p. 197.",
				"V. S. Shevelev, Reduced Latin rectangles and square matrices with equal row and column sums, Diskr. Mat. (J. of the Akademy of Sciences of Russia) 4(1992), 91-110. - _Vladimir Shevelev_, Mar 22 2010",
				"N. J. A. Sloane, A Handbook of Integer Sequences, Academic Press, 1973 (includes this sequence).",
				"N. J. A. Sloane and Simon Plouffe, The Encyclopedia of Integer Sequences, Academic Press, 1995 (includes this sequence).",
				"H. M. Taylor, A problem on arrangements, Mess. Math., 32 (1902), 60ff.",
				"J. Touchard, Permutations discordant with two given permutations, Scripta Math., 19 (1953), 108-119.",
				"J. H. van Lint, Combinatorial Theory Seminar, Eindhoven University of Technology, Springer Lecture Notes in Mathematics, Vol. 382, 1974. See page 10."
			],
			"link": [
				"Seiichi Manyama, \u003ca href=\"/A000179/b000179.txt\"\u003eTable of n, a(n) for n = 0..450\u003c/a\u003e (terms 0..100 from T. D. Noe)",
				"M. A. Alekseyev, Weighted de Bruijn Graphs for the Menage Problem and Its Generalizations. Lecture Notes in Computer Science 9843 (2016), 151-162. doi:\u003ca href=\"http://doi.org/10.1007/978-3-319-44543-4_12\"\u003e10.1007/978-3-319-44543-4_12\u003c/a\u003e arXiv:\u003ca href=\"http://arxiv.org/abs/1510.07926\"\u003e1510.07926\u003c/a\u003e, [math.CO], 2015-2016.",
				"Vladimir Baltic, \u003ca href=\"https://doi.org/10.2298/AADM1000008B\"\u003eOn the number of certain types of strongly restricted permutations\u003c/a\u003e, Applicable Analysis and Discrete Mathematics Vol. 4, No 1 (April, 2010), 119-135.",
				"Kenneth P. Bogart and Peter G. Doyle, \u003ca href=\"http://www.jstor.org/stable/2323022\"\u003eNonsexist solution of the ménage problem\u003c/a\u003e, Amer. Math. Monthly 93 (1986), no. 7, 514-519.",
				"A. de Gennaro, \u003ca href=\"https://arxiv.org/abs/0711.0527\"\u003eHow many latin rectangles are there?\u003c/a\u003e, arXiv:0711.0527 [math.CO] (2007), see p. 2.",
				"P. Flajolet and R. Sedgewick, \u003ca href=\"http://algo.inria.fr/flajolet/Publications/books.html\"\u003eAnalytic Combinatorics\u003c/a\u003e, 2009; see page 372",
				"Nick Hobson, \u003ca href=\"/A000179/a000179.py.txt\"\u003ePython program for this sequence\u003c/a\u003e",
				"Irving Kaplansky, \u003ca href=\"http://projecteuclid.org/euclid.bams/1183505432\"\u003eSolution of the \"Problème des ménages\"\u003c/a\u003e, Bull. Amer. Math. Soc. 49, (1943). 784-785.",
				"Irving Kaplansky, \u003ca href=\"http://projecteuclid.org/euclid.bams/1183506627\"\u003eSymbolic solution of certain problems in permutations\u003c/a\u003e, Bull. Amer. Math. Soc., 50 (1944), 906-914.",
				"S. M. Kerawala, \u003ca href=\"/A001569/a001569.pdf\"\u003eAsymptotic solution of the \"Probleme des menages\u003c/a\u003e, Bull. Calcutta Math. Soc., 39 (1947), 82-84. [Annotated scanned copy]",
				"V. Kotesovec, \u003ca href=\"https://oeis.org/wiki/User:Vaclav_Kotesovec\"\u003eNon-attacking chess pieces\u003c/a\u003e, 6ed, 2013, p. 221.",
				"D. E. Knuth, \u003ca href=\"/A000179/a000179.txt\"\u003eComments on A000179\u003c/a\u003e, Nov 25 2018 - Nov 27 2018.",
				"D. E. Knuth, \u003ca href=\"https://youtu.be/_cR9zDlvP88?t=2047\"\u003eDonald Knuth's 24th Annual Christmas Lecture: Dancing Links\u003c/a\u003e, Stanfordonline, Video published on YouTube, Dec 12, 2018.",
				"A. R. Kräuter, \u003ca href=\"http://www.mat.univie.ac.at/~slc/opapers/s11kraeu.html\"\u003eÜber die Permanente gewisser zirkulärer Matrizen...\u003c/a\u003e, Séminaire Lotharingien de Combinatoire, B11b (1984), 11 pp.",
				"Yiting Li, \u003ca href=\"https://cs.uwaterloo.ca/journals/JIS/VOL18/Li2/li51.html\"\u003eMénage Numbers and Ménage Permutations\u003c/a\u003e, J. Int. Seq. 18 (2015) 15.6.8",
				"E. Lucas, \u003ca href=\"http://gallica.bnf.fr/ark:/12148/bpt6k29021h\"\u003eThéorie des Nombres\u003c/a\u003e, Gauthier-Villars, Paris, 1891, Vol. 1, p. 495.",
				"Vladimir Shevelev, Peter J. C. Moses, \u003ca href=\"https://arxiv.org/abs/1101.5321\"\u003eThe ménage problem with a known mathematician\u003c/a\u003e, arXiv:1101.5321 [math.CO], 2011, 2015.",
				"Vladimir Shevelev and Peter J. C. Moses, \u003ca href=\"http://www.emis.de/journals/INTEGERS/papers/q72/q72.Abstract.html\"\u003eAlice and Bob go to dinner: A variation on menage\u003c/a\u003e, INTEGERS, Vol. 16 (2016), #A72.",
				"R. J. Stones, S. Lin, X. Liu, G. Wang, \u003ca href=\"https://dx.doi.org/10.1007/s00373-015-1643-1\"\u003eOn Computing the Number of Latin Rectangles\u003c/a\u003e, Graphs and Combinatorics (2016) 32:1187-1202; DOI 10.1007/s00373-015-1643-1.",
				"H. M. Taylor, \u003ca href=\"/A000179/a000179.pdf\"\u003eA problem on arrangements\u003c/a\u003e, Mess. Math., 32 (1902), 60ff. [Annotated scanned copy]",
				"J. Touchard, \u003ca href=\"http://visualiseur.bnf.fr/ark:/12148/bpt6k31506\"\u003eThéorie des substitutions. Sur un problème de permutations\u003c/a\u003e, C. R. Acad. Sci. Paris 198 (1934), 631-633.",
				"Eric Weisstein's World of Mathematics, \u003ca href=\"http://mathworld.wolfram.com/MarriedCouplesProblem.html\"\u003eMarried Couples Problem\u003c/a\u003e",
				"Eric Weisstein's World of Mathematics, \u003ca href=\"http://mathworld.wolfram.com/RooksProblem.html\"\u003eRooks Problem\u003c/a\u003e",
				"M. Wyman and L. Moser, \u003ca href=\"http://dx.doi.org/10.4153/CJM-1958-045-6\"\u003eOn the problème des ménages\u003c/a\u003e, Canad. J. Math., 10 (1958), 468-480.",
				"D. Zeilberger, \u003ca href=\"https://arxiv.org/abs/1401.1089\"\u003eAutomatic Enumeration of Generalized Menage Numbers\u003c/a\u003e, arXiv preprint arXiv:1401.1089 [math.CO], 2014."
			],
			"formula": [
				"a(n) = ((n^2-2*n)*a(n-1) + n*a(n-2) - 4(-1)^n)/(n-2) for n \u003e= 4.",
				"a(n) = A059375(n)/(2*n!).",
				"a(n) = Sum_{k=0..n} (-1)^k*(2*n)*binomial(2*n-k, k)*(n-k)!/(2*n-k). - Touchard (1934)",
				"G.f.: (1-x)/(1+x)*Sum_{n\u003e=0} n!*(x/(1+x)^2)^n. - _Vladeta Jovovic_, Jun 26 2007",
				"a(2^k+2)==0 (mod 2^k); for k\u003e=2, a(2^k)==2(mod 2^k). - _Vladimir Shevelev_, Jan 14 2011",
				"a(n) = round( 2*n*exp(-2)*BesselK(n,2) ) for n\u003e1. - _Mark van Hoeij_, Oct 25 2011",
				"a(n) ~ (n/e)^n * sqrt(2*Pi*n)/e^2. - _Charles R Greathouse IV_, Jan 21 2016",
				"0 = a(n)*(-a(n+2) +a(n+4)) +a(n+1)*(+a(n+1) +a(n+2) -3*a(n+3) -5*a(n+4) +a(n+5)) +a(n+2)*(+2*a(n+2) +3*a(n+3) -3*a(n+4)) +a(n+3)*(+2*a(n+3) +a(n+4) -a(n+5)) +a(n+4)*(+a(n+4)), for all n\u003e1. If a(-2..1) = (0, -1, 2, -1) then also true for those values of n. - _Michael Somos_, Apr 29 2018",
				"0 = a(n) +n*a(n+1) -2*a(n+2) +(-n-4)*a(n+3) +a(n+4), for all n in Z where a(n) = a(-n) for all n in Z and a(0) = 2, a(1) = -1. - _Michael Somos_, May 02 2018"
			],
			"example": [
				"a(0) = 1; () works. a(1) = 0; nothing works. a(2) = 0; nothing works. a(3) = 1; (201) works. a(4) = 2; (2301), (3012) work. a(5) = 13; (20413), (23401), (24013), (24103), (30412), (30421), (34012), (34021), (34102), (40123), (43012), (43021), (43102) work."
			],
			"maple": [
				"A000179:= n -\u003eadd ((-1)^k*(2*n)*binomial(2*n-k,k)*(n-k)!/(2*n-k), k=0..n); # for n \u003e= 1",
				"U:= proc(n) local k; add( (2*n/(2*n-k))*binomial(2*n-k,k)*(n-k)!*(x-1)^k, k=0..n); end; W := proc(r,s) coeff( U(r),x,s ); end; A000179 := n-\u003eW(n,0); # valid for n \u003e= 1"
			],
			"mathematica": [
				"a[n_] := 2*n*Sum[(-1)^k*Binomial[2*n - k, k]*(n - k)!/(2*n - k), {k, 0, n}]; a[0] = 1; a[1] = 0; Table[a[n], {n, 0, 21}] (* _Jean-François Alcover_, Dec 05 2012, from 2nd formula *)"
			],
			"program": [
				"(PARI) {a(n) = my(A); if( n\u003c3, n==0, A = vector(n); A[3] = 1; for(k=4, n, A[k] = (k * (k - 2) * A[k-1] + k * A[k-2] - 4 * (-1)^k) / (k-2)); A[n])}; /* _Michael Somos_, Jan 22 2008 */",
				"(PARI) a(n)=if(n,round(2*n*exp(-2)*besselk(n,2)),1) \\\\ _Charles R Greathouse IV_, Nov 03 2014",
				"(PARI) {a(n) = my(A); if( n\u003c3, n==0, n==3, 1, n==4, 2, A = vector(n); A[1] = -1; A[3] = 1; A[4] = 2; for(k=5, n, A[k] = k * A[k-1] + 2 * A[k-2] + (4-k) * A[k-3] - A[k-4]); A[n])}; /* _Michael Somos_, May 02 2018 */",
				"(Haskell)",
				"import Data.List (zipWith5)",
				"a000179 n = a000179_list !! n",
				"a000179_list = 1 : 0 : 0 : 1 : zipWith5",
				"   (\\v w x y z -\u003e (x * y + (v + 2) * z - w) `div` v) [2..] (cycle [4,-4])",
				"   (drop 4 a067998_list) (drop 3 a000179_list) (drop 2 a000179_list)",
				"-- _Reinhard Zumkeller_, Aug 26 2013"
			],
			"xref": [
				"Diagonal of A058087. Also a diagonal of A008305.",
				"Cf. A000904, A059375, A102761, A000186, A094047, A067998, A033999, A258664, A258665, A258666, A258667, A258673, A259212."
			],
			"keyword": "sign,nice,easy",
			"offset": "0,5",
			"author": "_N. J. A. Sloane_",
			"ext": [
				"More terms from _James A. Sellers_, May 02 2000",
				"Additional comments from _David W. Wilson_, Feb 18 2003",
				"a(1) changed to -1 at the suggestion of _Don Knuth_. - _N. J. A. Sloane_, Nov 26 2018"
			],
			"references": 51,
			"revision": 199,
			"time": "2019-01-09T09:39:30-05:00",
			"created": "1991-04-30T03:00:00-04:00"
		}
	]
}
