{
	"greeting": "Greetings from The On-Line Encyclopedia of Integer Sequences! http://oeis.org/",
	"query": "id:A000311",
	"count": 1,
	"start": 0,
	"results": [
		{
			"number": 311,
			"id": "M3613 N1465",
			"data": "0,1,1,4,26,236,2752,39208,660032,12818912,282137824,6939897856,188666182784,5617349020544,181790703209728,6353726042486272,238513970965257728,9571020586419012608,408837905660444010496,18522305410364986906624",
			"name": "Schroeder's fourth problem; also number of phylogenetic trees with n nodes; also number of total partitions of n.",
			"comment": [
				"a(n) = number of labeled series-reduced rooted trees with n leaves (root has degree 0 or \u003e= 2); a(n-1) = number of labeled series-reduced trees with n leaves. Also number of series-parallel networks with n labeled edges, divided by 2.",
				"A total partition of n is essentially what is meant by the first part of the previous line: take the numbers 12...n, and partition them into at least two blocks. Partition each block with at least 2 elements into at least two blocks. Repeat until only blocks of size 1 remain. (See the reference to Stanley, Vol. 2.) - _N. J. A. Sloane_, Aug 03 2016",
				"Polynomials with coefficients in triangle A008517, evaluated at 2. - _Ralf Stephan_, Dec 13 2004",
				"Row sums of unsigned A134685. - _Tom Copeland_, Oct 11 2008",
				"Row sums of A134991, which contains an e.g.f. for this sequence and its compositional inverse. - _Tom Copeland_, Jan 24 2018"
			],
			"reference": [
				"L. Comtet, Advanced Combinatorics, Reidel, 1974, p. 224.",
				"J. Felsenstein, Inferring phyogenies, Sinauer Associates, 2004; see p. 25ff.",
				"L. R. Foulds and R. W. Robinson, Enumeration of phylogenetic trees without points of degree two. Ars Combin. 17 (1984), A, 169-183. Math. Rev. 85f:05045",
				"J. W. Moon, Some enumerative results on series-parallel networks, Annals Discrete Math., 33 (1987), 199-226.",
				"T. S. Motzkin, Sorting numbers for cylinders and other classification numbers, in Combinatorics, Proc. Symp. Pure Math. 19, AMS, 1971, pp. 167-176.",
				"J. Riordan, Combinatorial Identities, Wiley, 1968, p. 197.",
				"J. Riordan, The blossoming of Schroeder's fourth problem, Acta Math., 137 (1976), 1-16.",
				"E. Schroeder, Vier combinatorische Probleme, Z. f. Math. Phys., 15 (1870), 361-376.",
				"N. J. A. Sloane, A Handbook of Integer Sequences, Academic Press, 1973 (includes this sequence).",
				"N. J. A. Sloane and Simon Plouffe, The Encyclopedia of Integer Sequences, Academic Press, 1995 (includes this sequence).",
				"R. P. Stanley, Enumerative Combinatorics, Cambridge, Vol. 2, 1999; see \"total partitions\", Example 5.2.5, Equation (5.27), and also Fig. 5-3 on page 14. See also the Notes on page 66."
			],
			"link": [
				"N. J. A. Sloane, \u003ca href=\"/A000311/b000311.txt\"\u003eTable of n, a(n) for n = 0..375\u003c/a\u003e [Shortened file because terms grow rapidly: see Sloane link below for additional terms]",
				"Mohamed Barakat, Reimer Behrends, Christopher Jefferson, Lukas Kühne, Martin Leuner, \u003ca href=\"https://arxiv.org/abs/1907.01073\"\u003eOn the generation of rank 3 simple matroids with an application to Terao's freeness conjecture\u003c/a\u003e, arXiv:1907.01073 [math.CO], 2019.",
				"Frédérique Bassino, Mathilde Bouvel, Valentin Féray, Lucas Gerin, Mickaël Maazoun, Adeline Pierrot, \u003ca href=\"https://arxiv.org/abs/1907.08517\"\u003eRandom cographs: Brownian graphon limit and asymptotic degree distribution\u003c/a\u003e, arXiv:1907.08517 [math.CO], 2019.",
				"A. Blass, N. Dobrinen, D. Raghavan, \u003ca href=\"http://arxiv.org/abs/1308.3790\"\u003eThe next best thing to a P-point\u003c/a\u003e, arXiv preprint arXiv:1308.3790 [math.LO], 2013.",
				"P. J. Cameron, \u003ca href=\"http://dx.doi.org/10.1093/qmath/38.2.155\"\u003eSome treelike objects\u003c/a\u003e, Quart. J. Math. Oxford, 38 (1987), 155-183. MR0891613 (89a:05009). See p. 155 and 159.",
				"P. J. Cameron, \u003ca href=\"http://www.cs.uwaterloo.ca/journals/JIS/VOL3/groups.html\"\u003eSequences realized by oligomorphic permutation groups\u003c/a\u003e, J. Integ. Seqs. Vol. 3 (2000), #00.1.5.",
				"L. Carlitz and J. Riordan, \u003ca href=\"http://dx.doi.org/10.1215/S0012-7094-56-02340-7\"\u003eThe number of labeled two-terminal series-parallel networks\u003c/a\u003e, Duke Math. J. 23 (1956), 435-445 (the sequence called {A_n}).",
				"Brian Drake, Ira M. Gessel, and Guoce Xin, \u003ca href=\"http://www.cs.uwaterloo.ca/journals/JIS/VOL10/Gessel/gessel20.html\"\u003eThree Proofs and a Generalization of the Goulden-Litsyn-Shevelev Conjecture on a Sequence Arising in Algebraic Geometry,\u003c/a\u003e J. of Integer Sequences, Vol. 10 (2007), Article 07.3.7",
				"John Engbers, David Galvin, Clifford Smyth, \u003ca href=\"https://arxiv.org/abs/1610.05803\"\u003eRestricted Stirling and Lah numbers and their inverses\u003c/a\u003e, arXiv:1610.05803 [math.CO], 2016.",
				"J. Felsenstein, \u003ca href=\"/A005373/a005373.pdf\"\u003eThe number of evolutionary trees\u003c/a\u003e, Systematic Zoology, 27 (1978), 27-33. (Annotated scanned copy)",
				"J. Felsenstein, \u003ca href=\"http://www.jstor.org/stable/2412810\"\u003eThe number of evolutionary trees\u003c/a\u003e, Systematic Biology, 27 (1978), pp. 27-33, 1978.",
				"S. R. Finch, \u003ca href=\"/A000084/a000084_2.pdf\"\u003eSeries-parallel networks\u003c/a\u003e, July 7, 2003. [Cached copy, with permission of the author]",
				"Steven R. Finch, \u003ca href=\"https://doi.org/10.1017/9781316997741\"\u003eMathematical Constants II\u003c/a\u003e, Encyclopedia of Mathematics and Its Applications, Cambridge University Press, Cambridge, 2018.",
				"Philippe Flajolet, \u003ca href=\"http://algo.inria.fr/libraries/autocomb/schroeder-html/schroeder1.html\"\u003eA Problem in Statistical Classification Theory\u003c/a\u003e",
				"P. Flajolet and R. Sedgewick, \u003ca href=\"http://algo.inria.fr/flajolet/Publications/books.html\"\u003eAnalytic Combinatorics\u003c/a\u003e, 2009; see page 129",
				"Daniel L. Geisler, \u003ca href=\"http://www.iteratedfunctions.com/Combinatorics/index.html\"\u003eCombinatorics of Iterated Functions\u003c/a\u003e",
				"INRIA Algorithms Project, \u003ca href=\"http://ecs.inria.fr/services/structure?nbr=69\"\u003eEncyclopedia of Combinatorial Structures 69\u003c/a\u003e",
				"V. P. Johnson, \u003ca href=\"http://www.math.sc.edu/~czabarka/JohnsonThesis.pdf\"\u003eEnumeration Results on Leaf Labeled Trees\u003c/a\u003e, Ph. D. Dissertation, Univ. Southern Calif., 2012.",
				"B. R. Jones, \u003ca href=\"http://summit.sfu.ca/item/14554\"\u003eOn tree hook length formulas, Feynman rules and B-series\u003c/a\u003e, Master's thesis, Simon Fraser University, 2014.",
				"Vladimir V. Kruchinin, \u003ca href=\"http://arxiv.org/abs/1211.3244\"\u003eThe method for obtaining expressions for coefficients of reverse generating functions\u003c/a\u003e, arXiv:1211.3244 [math.CO], 2012.",
				"Z. A. Lomnicki, \u003ca href=\"http://www.jstor.org/stable/1425808\"\u003eTwo-terminal series-parallel networks\u003c/a\u003e, Adv. Appl. Prob., 4 (1972), 109-150.",
				"Arnau Mir, Francesc Rossello, Lucia Rotger, \u003ca href=\"https://arxiv.org/abs/1805.01329\"\u003eSound Colless-like balance indices for multifurcating trees\u003c/a\u003e, arXiv:1805.01329 [q-bio.PE], 2018.",
				"T. S. Motzkin, \u003ca href=\"/A000262/a000262.pdf\"\u003eSorting numbers for cylinders and other classification numbers\u003c/a\u003e, in Combinatorics, Proc. Symp. Pure Math. 19, AMS, 1971, pp. 167-176. [Annotated, scanned copy]",
				"F. Murtagh, \u003ca href=\"http://dx.doi.org/10.1016/0166-218X(84)90066-0\"\u003eCounting dendrograms: a survey\u003c/a\u003e, Discrete Appl. Math., 7 (1984), 191-199.",
				"P. Regner, \u003ca href=\"http://suuf.cc/phyl-trees/\"\u003ePhylogenetic Trees: Selected Combinatorial Problems\u003c/a\u003e, Master Thesis, 2012, Institute of Discrete Mathematics and Geometry, TU Vienna, pp. 50-59",
				"J. Riordan, \u003ca href=\"/A000311/a000311.pdf\"\u003eLetter to N. J. A. Sloane, Jul. 1970\u003c/a\u003e",
				"E. Schröder, \u003ca href=\"/A000108/a000108_9.pdf\"\u003eVier combinatorische Probleme\u003c/a\u003e, Z. f. Math. Phys., 15 (1870), 361-376. [Annotated scanned copy]",
				"J. Taylor, \u003ca href=\"https://digital.lib.washington.edu/researchworks/handle/1773/36757\"\u003eFormal group laws and hypergraph colorings\u003c/a\u003e, doctoral thesis, Univ. of Wash., 2016, p. 95. [_Tom Copeland_, Dec 20 2018]",
				"N. J. A. Sloane, \u003ca href=\"/A000311/a000311.txt\"\u003eTable of n, a(n) for n = 0..500\u003c/a\u003e",
				"\u003ca href=\"/index/Tra#trees\"\u003eIndex entries for sequences related to trees\u003c/a\u003e",
				"\u003ca href=\"/index/Ro#rooted\"\u003eIndex entries for sequences related to rooted trees\u003c/a\u003e",
				"\u003ca href=\"/index/Cor#core\"\u003eIndex entries for \"core\" sequences\u003c/a\u003e",
				"\u003ca href=\"/index/Mo#Moon87\"\u003eIndex entries for sequences mentioned in Moon (1987)\u003c/a\u003e",
				"\u003ca href=\"/index/Par#parens\"\u003eIndex entries for sequences related to parenthesizing\u003c/a\u003e"
			],
			"formula": [
				"E.g.f. A(x) satisfies exp A(x) = 2*A(x) - x + 1.",
				"a(0)=0, a(1)=a(2)=1; for n \u003e= 2, a(n+1) = (n+2)*a(n) + 2*Sum_{k=2..n-1} binomial(n, k)*a(k)*a(n-k+1).",
				"a(1)=1; for n\u003e1, a(n) = -(n-1) * a(n-1) + Sum_{k=1..n-1} binomial(n, k) * a(k) * a(n-k). - _Michael Somos_, Jun 04 2012",
				"From the umbral operator L in A135494 acting on x^n comes, umbrally, (a(.) + x)^n = (n * x^(n-1) / 2) - (x^n / 2) + sum(j=1,...) [ j^(j-1) * 2^(-j) / j! * exp(-j/2) * (x+j/2)^n ] giving a(n) = 2^(-n) * sum(j\u003e=1) { j^(n-1) * [ (j/2) * exp(-1/2) ]^j / j! } for n \u003e 1. - _Tom Copeland_, Feb 11 2008",
				"Let h(x) = 1/(2-exp(x)), an e.g.f. for A000670, then the n-th term of A000311 is given by ((h(x)*d/dx)^n)x evaluated at x=0, i.e., A(x) = exp(x*a(.)) = exp(x*h(u)*d/du) u evaluated at u=0. Also, dA(x)/dx = h(A(x)). - _Tom Copeland_, Sep 05 2011",
				"A134991 gives (b.+c.)^n = 0^n , for (b_n)=A000311(n+1) and (c_0)=1, (c_1)=-1, and (c_n)=-2* A000311(n) = -A006351(n) otherwise. E.g., umbrally, (b.+c.)^2 = b_2*c_0 + 2 b_1*c_1 + b_0*c_2 =0. - _Tom Copeland_, Oct 19 2011",
				"a(n)=sum(k=1..n-1, (n+k-1)!*sum(j=1..k, 1/(k-j)!*sum(i=0..j, (2^i*(-1)^(i)*stirling2(n+j-i-1,j-i))/((n+j-i-1)!*i!)))), n\u003e1, a(0)=0, a(1)=1. - _Vladimir Kruchinin_, Jan 28 2012",
				"Using L. Comet's identity and D. Wasserman's explicit formula for the associated Stirling numbers of second kind (A008299) one gets: a(n) = sum(m=1..n-1, sum(i=0..m, (-1)^i * Binomial(n+m-1,i) * sum(j=0..m-i, (-1)^j * ((m-i-j)^(n+m-1-i))/(j! * (m-i-j)!)))). - _Peter Regner_, Oct 08 2012",
				"G.f.: x/Q(0), where Q(k)= 1 - k*x - x*(k+1)/Q(k+1); (continued fraction). - _Sergei N. Gladkovskii_, May 01 2013",
				"G.f.: x*Q(0), where Q(k) = 1 - x*(k+1)/(x*(k+1) - (1-k*x)*(1-x-k*x)/Q(k+1) ); (continued fraction). - _Sergei N. Gladkovskii_, Oct 11 2013",
				"a(n) ~ n^(n-1) / (sqrt(2) * exp(n) * (2*log(2)-1)^(n-1/2)). - _Vaclav Kotesovec_, Jan 05 2014",
				"E.g.f. A(x) satisfies d/dx A(x) = 1 / (1 + x - 2 * A(x)). - _Michael Somos_, Oct 25 2014",
				"O.g.f.: Sum_{n\u003e=0} x / Product_{k=0..n} (2 - k*x). - _Paul D. Hanna_, Oct 27 2014",
				"E.g.f.: (x - 1 - 2 LambertW(-exp((x-1)/2) / 2)) / 2. - _Vladimir Reshetnikov_, Oct 16 2015 (This e.g.f. is given in A135494, alluded to in my 2008 formula, and in A134991 along with its compositional inverse. - _Tom Copeland_, Jan 24 2018)",
				"a(0) = 0, a(1) = 1; a(n) = n! * [x^n] exp(Sum_{k=1..n-1} a(k)*x^k/k!). - _Ilya Gutkovskiy_, Oct 17 2017"
			],
			"example": [
				"E.g.f.: A(x) = x + x^2/2! + 4*x^3/3! + 26*x^4/4! + 236*x^5/5! + 2752*x^6/6! +...",
				"where exp(A(x)) = 1-x + 2*A(x), and thus",
				"Series_Reversion(A(x)) =  x - x^2/2! - x^3/3! - x^4/4! - x^5/5! - x^6/6! +...",
				"O.g.f.: G(x) = x + x^2 + 4*x^3 + 26*x^4 + 236*x^5 + 2752*x^6 + 39208*x^7 + ...",
				"where",
				"G(x) = x/2 + x/(2*(2-x)) + x/(2*(2-x)*(2-2*x)) + x/(2*(2-x)*(2-2*x)*(2-3*x)) + x/(2*(2-x)*(2-2*x)*(2-3*x)*(2-4*x)) + x/(2*(2-x)*(2-2*x)*(2-3*x)*(2-4*x)*(2-5*x)) +..."
			],
			"maple": [
				"M:=499; a:=array(0..500); a[0]:=0; a[1]:=1; a[2]:=1; for n from 0 to 2 do lprint(n,a[n]); od: for n from 2 to M do a[n+1]:=(n+2)*a[n]+2*add(binomial(n,k)*a[k]*a[n-k+1],k=2..n-1); lprint(n+1,a[n+1]); od:",
				"Order := 50; t1 := solve(series((exp(A)-2*A-1),A)=-x,A); A000311 := n-\u003e n!*coeff(t1,x,n);",
				"# second Maple program:",
				"b:= proc(n, i) option remember; `if`(n=0, 1, `if`(i\u003c1, 0,",
				"      add(combinat[multinomial](n, n-i*j, i$j)/j!*",
				"      a(i)^j*b(n-i*j, i-1), j=0..n/i)))",
				"    end:",
				"a:= n-\u003e `if`(n\u003c2, n, b(n, n-1)):",
				"seq(a(n), n=0..40);  # _Alois P. Heinz_, Jan 28 2016"
			],
			"mathematica": [
				"nn = 19; CoefficientList[ InverseSeries[ Series[1+2a-E^a, {a, 0, nn}], x], x]*Range[0, nn]! (* _Jean-François Alcover_, Jul 21 2011 *)",
				"a[ n_] := If[ n \u003c 1, 0, n! SeriesCoefficient[ InverseSeries[ Series[ 1 + 2 x - Exp[x], {x, 0, n}]], n]]; (* _Michael Somos_, Jun 04 2012 *)",
				"a[n_] := (If[n \u003c 2,n,(column = ConstantArray[0, n - 1]; column[[1]] = 1; For[j = 3, j \u003c= n, j++, column = column * Flatten[{Range[j - 2], ConstantArray[0, (n - j) + 1]}] + Drop[Prepend[column, 0], -1] * Flatten[{Range[j - 1, 2*j - 3], ConstantArray[0, n - j]}];]; Sum[column[[i]], {i, n - 1}]  )]); Table[a[n], {n, 0, 20}] (* _Peter Regner_, Oct 05 2012, after a formula by Felsenstein (1978) *)",
				"multinomial[n_, k_List] := n!/Times @@ (k!); b[n_, i_] := b[n, i] = If[n == 0, 1, If[i\u003c1, 0, Sum[multinomial[n, Join[{n-i*j}, Array[i\u0026,j]]]/j!*a[i]^j *b[n-i*j, i-1], {j, 0, n/i}]]]; a[n_] := If[n\u003c2, n, b[n, n-1]]; Table[ a[n], {n, 0, 40}] (* _Jean-François Alcover_, Feb 07 2016, after _Alois P. Heinz_ *)"
			],
			"program": [
				"(PARI) {a(n) = local(A); if( n\u003c0, 0, for( i=1, n, A = Pol(exp(A + x * O(x^i)) - A + x - 1)); n! * polcoeff(A, n))}; /* _Michael Somos_, Jan 15 2004 */",
				"(PARI) {a(n) = my(A); if( n\u003c0, 0, A = O(x); for( i=1, n, A = intformal( 1 / (1 + x - 2*A))); n! * polcoeff(A, n))}; /* _Michael Somos_, Oct 25 2014 */",
				"(Maxima) a(n):=if n=1 then 1 else sum((n+k-1)!*sum(1/(k-j)!*sum((2^i*(-1)^(i)*stirling2(n+j-i-1,j-i))/((n+j-i-1)!*i!),i,0,j),j,1,k),k,1,n-1); /* _Vladimir Kruchinin_, Jan 28 2012 */",
				"(PARI) {a(n) = n! * polcoeff(serreverse(1+2*x - exp(x +x^2*O(x^n))), n)}",
				"for(n=0, 30, print1(a(n), \", \")) \\\\ _Paul D. Hanna_, Oct 27 2014",
				"(PARI) \\p100 \\\\ set precision",
				"{A=Vec(sum(n=0, 600, 1.*x/prod(k=0, n, 2 - k*x + O(x^31))))}",
				"for(n=0, 25, print1(if(n\u003c1,0,round(A[n])),\", \")) \\\\ _Paul D. Hanna_, Oct 27 2014"
			],
			"xref": [
				"Cf. A000669, A001003, A007827, A005804, A005805, A006351, A000084.",
				"For n \u003e= 2, A000311(n) = A006351(n)/2 = A005640(n)/2^(n+1).",
				"Cf. A000110, A000669 = unlabeled hierarchies, A119649.",
				"Row sums of A064060.",
				"Cf. A000670, A135494.",
				"Cf. A134685, A134991."
			],
			"keyword": "nonn,core,easy,nice",
			"offset": "0,4",
			"author": "_N. J. A. Sloane_",
			"references": 77,
			"revision": 194,
			"time": "2019-10-04T20:05:20-04:00",
			"created": "1991-04-30T03:00:00-04:00"
		}
	]
}
